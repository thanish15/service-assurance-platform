<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Service Assurance — Live Collector</title>

<meta http-equiv="refresh" content="30" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  :root{
    --bg1:#0f2027;
    --bg2:#203a43;
    --bg3:#2c5364;
    --accent:#19ff75;
    --soft-white:#f5f5f5;
    --glass: rgba(255,255,255,0.06);
  }

  body{
    margin:0;
    font-family: Inter, Arial, sans-serif;
    background: linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));
    color: var(--soft-white);
  }

  .container{
    max-width:1200px;
    margin:30px auto;
    padding:20px;
  }

  header{
    text-align:center;
    margin-bottom:25px;
  }

  .title{
    font-size: clamp(32px, 5vw, 58px);
    font-weight: 900;
    letter-spacing: 1.4px;
    background: linear-gradient(90deg,var(--accent),#eafff0);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    margin:0;
    text-shadow: 0 10px 28px rgba(0,0,0,0.45);
  }

  .blurb{
    max-width:850px;
    margin:10px auto 0;
    font-size:17px;
    line-height:1.5;
    color: rgba(240,255,240,0.9);
  }

  /* FLOWCARD */
  .flowcard{
    background: rgba(255,255,255,0.05);
    border-radius:16px;
    padding:24px;
    margin-top:25px;
    position:relative;
    box-shadow:0 10px 28px rgba(0,0,0,0.4);
  }

  .flow-wrap{
    display:flex;
    align-items:center;
    justify-content:space-between;
  }

  /* NODE */
  .node{
    width:140px;
    text-align:center;
    padding:14px 10px;
    background: var(--glass);
    border-radius:14px;
    box-shadow:0 8px 22px rgba(0,0,0,0.55);
    transition:all .25s ease;
  }

  .node:hover{
    transform: translateY(-6px);
    box-shadow:0 14px 30px rgba(0,0,0,0.65);
  }

  .icon{
    width:48px;
    height:48px;
  }

  .label{
    margin-top:8px;
    font-size:14px;
    font-weight:700;
  }

  .sub{
    margin-top:4px;
    font-size:11px;
    opacity:0.7;
  }

  /* CONNECTOR BAR (LEFT→RIGHT ANIMATION) */
  .connector{
    width:100px;
    height:8px;
    border-radius:8px;
    background: linear-gradient(90deg,rgba(25,255,117,0.9),rgba(25,255,117,0.3));
    position:relative;
    overflow:visible;
    box-shadow:0 0 12px rgba(25,255,117,0.4);
  }

  .connector .scrub{
    position:absolute;
    top:50%;
    left:-10%;
    width:12px;
    height:12px;
    border-radius:12px;
    background:white;
    box-shadow: 0 0 12px rgba(25,255,117,1);
    transform:translate(-50%,-50%);
    animation: scrubMove 2.4s linear infinite;
  }

  /* PURE left→right only */
  @keyframes scrubMove{
    0%   { left:-10%; }
    100% { left:110%; }
  }

  /* different delays for each connector */
  .connector:nth-of-type(1) .scrub { animation-delay:0s; }
  .connector:nth-of-type(2) .scrub { animation-delay:0.4s; }
  .connector:nth-of-type(3) .scrub { animation-delay:0.8s; }
  .connector:nth-of-type(4) .scrub { animation-delay:1.2s; }

  .card{
    background: rgba(255,255,255,0.05);
    border-radius:14px;
    padding:20px;
    margin-top:25px;
    box-shadow:0 10px 24px rgba(0,0,0,0.4);
  }

  table{
    width:100%;
    margin-top:10px;
    border-collapse:collapse;
    font-size:14px;
  }

  th,td{
    padding:10px 12px;
    border-bottom:1px solid rgba(255,255,255,0.08);
  }

  th{
    background:rgba(25,255,117,0.15);
    font-weight:700;
  }

  tr:hover{
    background:rgba(25,255,117,0.08);
  }

  footer{
    margin-top:40px;
    text-align:center;
    font-size:13px;
    color:rgba(255,255,255,0.6);
  }
</style>
</head>

<body>
<div class="container">

  <header>
    <h1 class="title">Service Assurance — Live Collector</h1>
    <div class="blurb">SNMP-driven lightweight monitoring pipeline with real-time visualization, database persistence, and a clean interactive flowchart.</div>
  </header>

  <!-- FLOWCHART -->
  <section class="flowcard">
    <div class="flow-wrap">

      <!-- NODE 1 -->
      <div class="node">
        <svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="9" stroke="white" fill="none"/><path d="M12 7v6l4 2" stroke="#19ff75"/></svg>
        <div class="label">Timestamp</div>
        <div class="sub">when collected</div>
      </div>

      <div class="connector"><div class="scrub"></div></div>

      <!-- NODE 2 -->
      <div class="node">
        <svg class="icon" viewBox="0 0 24 24"><rect x="2" y="6" width="20" height="12" rx="2" stroke="white" fill="none"/><rect x="7" y="14" width="10" height="2" rx="1" fill="#19ff75"/></svg>
        <div class="label">Device IP</div>
        <div class="sub">source</div>
      </div>

      <div class="connector"><div class="scrub"></div></div>

      <!-- NODE 3 -->
      <div class="node">
        <svg class="icon" viewBox="0 0 24 24"><path d="M3 12h4l3 8 4-16 3 8h4" stroke="white" fill="none"/></svg>
        <div class="label">Metric Name</div>
        <div class="sub">type</div>
      </div>

      <div class="connector"><div class="scrub"></div></div>

      <!-- NODE 4 -->
      <div class="node">
        <svg class="icon" viewBox="0 0 24 24"><path d="M4 6h16M4 12h10M4 18h7" stroke="white"/></svg>
        <div class="label">OID</div>
        <div class="sub">identifier</div>
      </div>

      <div class="connector"><div class="scrub"></div></div>

      <!-- NODE 5 -->
      <div class="node">
        <svg class="icon" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="16" rx="2" stroke="white" fill="none"/><text x="12" y="15" text-anchor="middle" fill="#19ff75" font-size="10">#</text></svg>
        <div class="label">Value</div>
        <div class="sub">SNMP data</div>
      </div>

    </div>
  </section>

  <!-- CHART -->
  <section class="card">
    <canvas id="uptimeChart"></canvas>
  </section>

  <!-- TABLE -->
  <section class="card">
    <h3>Recent Metrics</h3>
    <table>
      <thead>
        <tr><th>Timestamp</th><th>Device IP</th><th>Metric</th><th>OID</th><th>Value</th></tr>
      </thead>
      <tbody id="metricsTable">
        {% for row in metrics %}
        <tr>
          <td>{{ row[0] }}</td>
          <td>{{ row[1] }}</td>
          <td>{{ row[2] }}</td>
          <td>{{ row[3] }}</td>
          <td>{{ row[4] }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

  <footer>
    Service Assurance — Live Collector • Made for Project Submission  
  </footer>

</div>

<script>
  function renderChart(){
    fetch('/metrics_data')
      .then(r=>r.json())
      .then(json=>{
        const ctx=document.getElementById('uptimeChart').getContext('2d');
        if(window._chart) window._chart.destroy();

        window._chart=new Chart(ctx,{
          type:'line',
          data:{
            labels:json.labels,
            datasets:[{
              label:'sysUpTime',
              data:json.data,
              borderColor:'rgba(25,255,117,0.9)',
              backgroundColor:'rgba(25,255,117,0.12)',
              tension:0.25,
              fill:true
            }]
          },
          options:{
            responsive:true,
            plugins:{legend:{display:false}},
            scales:{
              x:{ticks:{color:'white'},grid:{display:false}},
              y:{ticks:{color:'white'}}
            }
          }
        });
      });
  }

  renderChart();
  setInterval(renderChart,20000);
</script>

</body>
</html>
